# 忍者バトル操作ガイド

本プロジェクトに追加された忍術システムや操作方法をまとめました。Unity エディター上でプレイする際の参考にしてください。

## 基本操作
- **移動**: `A` / `D` または ← / → キーで左右に移動します。速度と加速は `PlayerController` の `Move Speed` と `Acceleration` で調整できます。
- **ジャンプ**: `Space` キーでジャンプします。ジャンプ力は `Jump Force` で設定できます。
- **スクロール補充**: `↑` キーを押すと、忍術スロットが空になるまで自動でスクロール（属性）を補充します。属性は火・水・風の3種類がバランスよく配布されます。
- **忍術発動**: `←` キーで、現在のスロット構成に応じた忍術を発動します。発動位置は `Projectile Spawn Point` に設定したトランスフォームを基準にします。

## 忍術スロットとコンボ
`NinjutsuManager` はプレイヤーの忍術スロットを管理し、以下の順番で発動内容を判定します。

1. **コンボ判定**: 先頭の2枠をチェックし、下記の属性ペアと一致した場合はコンボ忍術が発動します。
   | 組み合わせ | 忍術 | 効果概要 |
   | --- | --- | --- |
   | 火 + 火 | 火炎防壁 (`FireFireBarrier`) | 周囲に複数回ダメージパルスを発生させます。範囲は `Fire Fire Radius`、ヒット回数は `Fire Fire Hits` で調整可能です。 |
   | 水 + 風 | 水風竜巻 (`WaterWindTornado`) | 前方に竜巻エフェクトを生成し、持続的に接触ダメージを与えます。幅と持続時間は `Tornado Width`、`Tornado Duration` で設定します。 |
   | 風 + 火 | 風火火球 (`WindFireFireball`) | 前方へ火球を射出します。速度は `Fireball Speed` で管理されます。 |
2. **単属性判定**: コンボに該当しない場合、先頭1枠のみを消費して以下の単体忍術を発動します。
   | 属性 | 忍術 | 効果概要 |
   | --- | --- | --- |
   | 火 | 爆炎 (`FireExplosion`) | 即座に周囲へ広範囲のダメージパルスを放ちます。範囲は `Fire Single Radius` を参照します。 |
   | 水 | 水矢 (`WaterArrows`) | 3方向に水矢を放ち、各矢は近くの敵を追尾します。速度と拡散角は `Water Arrow Speed`、`Water Arrow Spread` で調整できます。 |
   | 風 | 風盾 (`WindShield`) | プレイヤーの周囲に防御シールドを生成し、接触した敵にダメージを与えつつ押し返します。半径は `Wind Shield Radius` を利用します。 |

忍術を発動すると使用した属性はスロットから消費され、同時に内部的な属性バランスカウンターも減少します。これにより次回補充時には不足している属性が優先され、偏りを防ぎます。

## UI とパラメーター調整
- **ハートUI (`HeartUIController`)**: `Health` コンポーネントと連動して現在のHPをハートアイコンで表示します。ハートの最大数やスプライトはインスペクター上で設定します。
- **忍術スロットUI (`NinjutsuSlotUI`)**: スロットの属性を色分けで表示します。必要なスロット数やアイコンは `NinjutsuManager` から通知され、自動で更新されます。
- **ダメージ判定**: `IDamageable` インターフェースを実装したオブジェクトが忍術のダメージを受けられます。`AreaDamageEmitter`、`Projectile`、`WindShield` などはこのインターフェースを通じてダメージを与えます。

## テストの進め方
Unity エディターでプレイモードに入り、上記キー操作を試して挙動を確認してください。パラメーターを変更した場合は、インスペクターで値を調整しながら期待通りのバランスになるか都度テストするのがおすすめです。

